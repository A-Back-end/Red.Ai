# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ API Projects –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ RedAI

## –ü—Ä–æ–±–ª–µ–º–∞
POST –∑–∞–ø—Ä–æ—Å –Ω–∞ `https://redai.site/api/projects` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É 500 (Internal Server Error).

## –ü—Ä–∏—á–∏–Ω–∞
–í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ nginx –≤—Å–µ `/api/` –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ–∫—Å–∏—Ä—É—é—Ç—Å—è –Ω–∞ backend (FastAPI), –Ω–æ API endpoint `/api/projects` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ (frontend).

## –†–µ—à–µ–Ω–∏–µ

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ nginx

–°–æ–∑–¥–∞–Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `nginx-redai-fixed.conf`, –∫–æ—Ç–æ—Ä–∞—è:
- –ü—Ä–æ–∫—Å–∏—Ä—É–µ—Ç `/api/projects` –Ω–∞ frontend (Next.js)
- –ü—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã–µ `/api/` –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ backend (FastAPI)

### 2. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

#### –í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ Docker Compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose -f docker-compose.prod.yml down

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
docker-compose -f docker-compose.prod.yml up -d
```

#### –í–∞—Ä–∏–∞–Ω—Ç B: –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ nginx
```bash
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
sudo cp nginx-redai-fixed.conf /etc/nginx/nginx.conf

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
sudo nginx -t

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å nginx
sudo nginx -s reload
```

#### –í–∞—Ä–∏–∞–Ω—Ç C: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
./fix-nginx-config.sh
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

#### –¢–µ—Å—Ç —á–µ—Ä–µ–∑ curl
```bash
curl -X POST https://redai.site/api/projects \
  -H "Content-Type: application/json" \
  -d '{"name":"Test Project","description":"Test","userId":"test-user"}'
```

#### –¢–µ—Å—Ç —á–µ—Ä–µ–∑ Node.js
```bash
node test-projects-api.js
```

### 4. –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è API –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å:
```json
{
  "success": true,
  "project": {
    "id": "project_1234567890_abc123",
    "name": "Test Project",
    "description": "Test",
    "userId": "test-user",
    "createdAt": "2025-07-22T11:43:43.332Z",
    "updatedAt": "2025-07-22T11:43:43.332Z",
    "status": "draft",
    "budget": {
      "min": 50000,
      "max": 200000,
      "currency": "RUB"
    },
    "preferredStyles": ["modern"],
    "restrictions": [],
    "generatedImages": [],
    "roomAnalysis": null,
    "designRecommendation": null,
    "threeDModel": null,
    "pdfReport": null,
    "shoppingList": null
  }
}
```

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π

1. `nginx-redai-fixed.conf` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è nginx
2. `docker-compose.prod.yml` - –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
3. `fix-nginx-config.sh` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
4. `app/api/projects/route.ts` - —É–ª—É—á—à–µ–Ω —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

API endpoint —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –í—Å–µ –≤—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –û—à–∏–±–∫–∏ —Å –¥–µ—Ç–∞–ª—è–º–∏
- –£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

–õ–æ–≥–∏ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ Next.js —Å–µ—Ä–≤–µ—Ä–∞.

## –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

–í —Å–ª—É—á–∞–µ –ø—Ä–æ–±–ª–µ–º –º–æ–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å backup –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ nginx
sudo cp /etc/nginx/nginx.conf.backup.* /etc/nginx/nginx.conf

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å nginx
sudo nginx -s reload
``` 