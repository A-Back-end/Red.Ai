# ‚úÖ Google Tag Manager - –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

## üéØ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

1. **GTM –∫–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω** –≤ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã:
   - `app/layout.tsx` - Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
   - `public/index.html` - —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞

2. **–°–æ–∑–¥–∞–Ω—ã —É—Ç–∏–ª–∏—Ç—ã** –¥–ª—è —Ç—Ä–µ–∫–∏–Ω–≥–∞:
   - `lib/gtm.ts` - –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
   - `lib/useGTM.ts` - React —Ö—É–∫–∏

3. **–î–æ–±–∞–≤–ª–µ–Ω —Ç—Ä–µ–∫–∏–Ω–≥** –≤ –∫–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
   - Dashboard –Ω–∞–≤–∏–≥–∞—Ü–∏—è
   - Design Studio –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
   - AI Assistant –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

4. **–°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**:
   - `docs/GTM_SETUP.md` - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
   - `test-gtm.html` - —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞

## üß™ –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ù–∞–∂–º–∏—Ç–µ F12 (Developer Tools)
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É Console
4. –í–≤–µ–¥–∏—Ç–µ: `window.dataLayer`
5. –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å—Å—è –º–∞—Å—Å–∏–≤ —Å —Å–æ–±—ã—Ç–∏—è–º–∏

### 2. –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ `test-gtm.html` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏–π
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π:
   ```
   üìä GTM Event sent: page_view {page_path: "/dashboard"}
   ```

### 3. GTM Preview Mode

1. –í–æ–π–¥–∏—Ç–µ –≤ [Google Tag Manager](https://tagmanager.google.com/)
2. –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä `GTM-KMRVH2GD`
3. –ù–∞–∂–º–∏—Ç–µ "Preview" (–∫–Ω–æ–ø–∫–∞ —Å–ø—Ä–∞–≤–∞ –æ—Ç "Submit")
4. –í–≤–µ–¥–∏—Ç–µ URL –≤–∞—à–µ–≥–æ —Å–∞–π—Ç–∞
5. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ
6. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## üìä –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ —Å–æ–±—ã—Ç–∏—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ
- `page_view` - –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏
- `user_interaction` - –ø—Ä–∏ –∫–ª–∏–∫–∞—Ö –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è—Ö

### –†—É—á–Ω—ã–µ (–¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
- `ai_feature_usage` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AI —Ñ—É–Ω–∫—Ü–∏–π
- `design_generation` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∏–∑–∞–π–Ω–æ–≤
- `user_registration` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `project_creation` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤
- `credit_usage` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–æ–≤

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ GTM

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤

–°–æ–∑–¥–∞–π—Ç–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ —Å–æ–±—ã—Ç–∏–π:

```
–ù–∞–∑–≤–∞–Ω–∏–µ: AI Feature Usage
–¢–∏–ø: Custom Event
–°–æ–±—ã—Ç–∏–µ: ai_feature_usage

–ù–∞–∑–≤–∞–Ω–∏–µ: Design Generation
–¢–∏–ø: Custom Event  
–°–æ–±—ã—Ç–∏–µ: design_generation

–ù–∞–∑–≤–∞–Ω–∏–µ: User Registration
–¢–∏–ø: Custom Event
–°–æ–±—ã—Ç–∏–µ: user_registration
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–≥–æ–≤

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ç–µ–≥–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö:

```
–ù–∞–∑–≤–∞–Ω–∏–µ: GA4 - AI Events
–¢–∏–ø: Google Analytics: GA4 Event
–¢—Ä–∏–≥–≥–µ—Ä: AI Feature Usage
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- event_name: ai_feature_usage
- feature: {{Event Parameter - feature}}
- action: {{Event Parameter - action}}
```

### 3. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:

```
–ù–∞–∑–≤–∞–Ω–∏–µ: Event Parameter - feature
–¢–∏–ø: Event Parameter
–ò–º—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞: feature

–ù–∞–∑–≤–∞–Ω–∏–µ: Event Parameter - action  
–¢–∏–ø: Event Parameter
–ò–º—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞: action
```

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É** –∏—Å–ø–æ–ª—å–∑—É—è —Ç–µ—Å—Ç–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã –∏ —Ç–µ–≥–∏** –≤ GTM
3. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ Google Analytics 4** –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ü–µ–ª–∏** –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–æ–Ω–≤–µ—Ä—Å–∏–π
5. **–î–æ–±–∞–≤—å—Ç–µ —Ç—Ä–µ–∫–∏–Ω–≥** –≤ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö React

```typescript
import { useGTM } from '@/lib/useGTM'

export function MyComponent() {
  const { trackInteraction, trackAI } = useGTM()
  
  const handleClick = () => {
    trackInteraction('click', 'button', 'cta_button')
  }
  
  const handleAIAction = () => {
    trackAI('feature_name', 'action_type', { param: 'value' })
  }
  
  return (
    <button onClick={handleClick}>
      Click me
    </button>
  )
}
```

### –ü—Ä—è–º–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π

```typescript
import { sendGTMEvent } from '@/lib/gtm'

sendGTMEvent('custom_event', {
  category: 'test',
  action: 'click',
  label: 'button'
})
```

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏

```javascript
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å dataLayer
console.log(window.dataLayer)

// –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ
window.dataLayer.push({
  event: 'test_event',
  test_param: 'test_value'
})
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ GTM

1. –í–∫–ª—é—á–∏—Ç–µ Preview Mode
2. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—è
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–±—ã—Ç–∏—è –≤ GTM Debugger

## ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

GTM –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è, —Å–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏. 